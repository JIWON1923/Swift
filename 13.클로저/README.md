# 클로저
- 프로그래밍 패러다임
    - 클로저, 제네릭, 프로토콜, 모나드 등
- 클로저
    - 일정 기능을 하는 코드를 하나의 블록으로 모아놓은 것
    - 함수 : 클로저의 한 형태
    - 변수나 상수가 선언된 위치에서 참조를 획득하고 저장할 수 있다.
    - 형태
        - 이름이 있으면서 어떤 값도 획득하지 않는 전역함수의 형태
        - 이름이 있으면서 다른 함수 내부의 값을 획득할 수 있는 중첩된 함수의 형태
        - 이름이 없고 주변 문맥에 따라 값을 획득할 수 있는 축약 문법으로 작성한 형태
    - 표현
        - 매개변수와 반환 값의 타입 생략 가능 (유추가 가능하므로)
        - 단 한 줄의 표현만 들어있다면 암시적으로 반환값으로 취급
        - 축약된 전달인자 이름을 사용할 수 있음
        - 후행 클로저 문법을 사용할 수 있음
        
---
    
## 기본 클로저
- 기본 형태
    - 입출력 매개변수 사용 가능
    - 가변 매개변수 사용 가능(매개변수 이름 지정 시)
    - 매개변수 기본값은 사용 불가


```swift
{(매개변수들) -> 반환타입 in
    //실행코드
}
```


## 후행 클로저
- 사용
    - 클로저의 가독성이 떨어지면 사용
    - 맨 마지막 전달인자로 전달되는 클로저에만 해당된다.
    - 단 하나의 클로저만 전달인자로 전달할 경우는 소괄호를 생략할 수 있다.
    - 매개변수에 여러개의 클로저가 있다면, 다중 후행 클로저 문법을 사용할 수 있다.
    
    
## 클로저 표현 간소화
- 문맥을 이용한 타입 유추
    - 메서드의 전달인자로 전달하는 클로저는 메서드에서 요구하는 형태로 전달해야한다.
    - 즉, 메서드의 타입, 개수, 반환 타입 등이 같아야 전달인자로 전달할 수 있다. (적합한 타입을 준수 -> 타입, 반환값 생략 가능한 이유)
        
- 단축 인자 이름
    - $와 숫자의 조합으로 표현
    - 매개변수 및 반환 타입과 실행코드를 구분하기 위해 사용했던 키워드 in을 사용하지 않아도 된다. 
    
- 암시적 반환 표현
    - return 키워드 생략 가능
    - 클로저가 반환 값을 갖고, 내부의 실행문이 한 줄이라면, 암시적으로 해당 실행물이 반환값으로 사용된다.
        
## 값 획득
- 획득(capture)
    - 클로저는 자신이 정의된 위치의 주변 문맥을 통해 상수나 변수를 획득할 수 있다.
    - 클로저는 획득을 통해 주변에 정의한 상수나 변수가 더 이상 존재하지 않더라도, 자신 내부에서 참조하거나 수정할 수 있다. (비동기 작업에서 많이 사용)
    - 클로저를 통해 비동기 콜백을 작서하는 경우, 현 상태를 미리 획득하지 않으면 실제 클로저 기능이 실행되는 순간에는 이미 메모리에 존재하지 않을 수 있다.
    
## 클로저는 참조 타입

## 탈출 클로저
- 탈출(Escape)
    - 함수의 전달인자로 전달한 클로저가 함수 종료 후 호출될 때 클로저가 함수를 탈출한다라고 표현한다.
    - @escape 키워드로 클로저가 탈출하는 것을 허용한다고 명시
    - 명시하지 않으면 컴파일 오류가 발생한다.
    - 탈출 클로저임을 명시한 경우, 클로저 내부에서 해당 타입의 프로퍼티나 메서드, 서브스크립트 등에 접근하려면 self 키워드를 명시적으로 사용해야 한다.
    - 위 키워드가 없다면 비탈출 클로저이다.
        - 함수의 동작이 끝난 후 사용할 필요가 없을 때
        - self 키워드를 꼭 써주지 않아도 된다. (선택사항)

- withoutActuallyEscaping
    - 클로저가 탈출 클로저인양 사용할 수 있게 돕는 함수
    - 즉, 비탈출 클로저를 탈출 클로저처럼 사용할 수 있도록 한다.
    
## 자동 클로저
- 개념
    - 함수의 전달인자로 전달하는 표현을 자동으로 변환해주는 클로저
    - 전달인자를 갖지 않는다.
    - 자신이 호출되었을 때 자신이 감싸고 있는 코드의 결괏값을 반환한다.
    
- 지연
    - 자동 클로저는 클로저가 호출되기 전까지 클로저 내부 코드가 동작하지 않는다.
    - 연산에 자원을 많이 소모하거나 부작용이 우려될 때 사용할 수 있다.
    
- 주의
    - 자동클로저의 과도한 사용은 코드를 이해하기 어렵게 만들 가능성이 높다.
    - 사용한다면 함수 이름 또는 매개변수 이름 등은 자동 클로저를 사용한다는 명확한 의밀르 전달할 수 있도록 명명하는 것이 좋다.
    
